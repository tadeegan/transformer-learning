ViT(
  (positional_embedding): PositionalEmbedding2d()
  (encoder_blocks): Sequential(
    (0): TransformerEncoderBlock(
      (norm1): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (msa): MultiHeadSelfAttention(
        (lin_k): Linear(in_features=28, out_features=28, bias=True)
        (lin_q): Linear(in_features=28, out_features=28, bias=True)
        (lin_v): Linear(in_features=28, out_features=28, bias=True)
      )
      (MLP): MLP(
        (layers): ModuleList(
          (0): Linear(in_features=28, out_features=28, bias=True)
          (1): Linear(in_features=28, out_features=28, bias=True)
        )
      )
    )
    (1): TransformerEncoderBlock(
      (norm1): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (msa): MultiHeadSelfAttention(
        (lin_k): Linear(in_features=28, out_features=28, bias=True)
        (lin_q): Linear(in_features=28, out_features=28, bias=True)
        (lin_v): Linear(in_features=28, out_features=28, bias=True)
      )
      (MLP): MLP(
        (layers): ModuleList(
          (0): Linear(in_features=28, out_features=28, bias=True)
          (1): Linear(in_features=28, out_features=28, bias=True)
        )
      )
    )
    (2): TransformerEncoderBlock(
      (norm1): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (msa): MultiHeadSelfAttention(
        (lin_k): Linear(in_features=28, out_features=28, bias=True)
        (lin_q): Linear(in_features=28, out_features=28, bias=True)
        (lin_v): Linear(in_features=28, out_features=28, bias=True)
      )
      (MLP): MLP(
        (layers): ModuleList(
          (0): Linear(in_features=28, out_features=28, bias=True)
          (1): Linear(in_features=28, out_features=28, bias=True)
        )
      )
    )
    (3): TransformerEncoderBlock(
      (norm1): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (msa): MultiHeadSelfAttention(
        (lin_k): Linear(in_features=28, out_features=28, bias=True)
        (lin_q): Linear(in_features=28, out_features=28, bias=True)
        (lin_v): Linear(in_features=28, out_features=28, bias=True)
      )
      (MLP): MLP(
        (layers): ModuleList(
          (0): Linear(in_features=28, out_features=28, bias=True)
          (1): Linear(in_features=28, out_features=28, bias=True)
        )
      )
    )
  )
  (final_mlp): MLP(
    (layers): ModuleList(
      (0): Linear(in_features=28, out_features=10, bias=True)
    )
  )
)
patches_train.shape: (60000, 49, 16)

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 29.18it/s]
loss: [100]: 229.65859985351562
Valition (on train):
Valition (on test):
Accuracy (on test): 0.14
 68%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 68/100 [00:01<00:00, 36.55it/s]
loss: [200]: 229.42544555664062
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.17it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.07it/s]
loss: [300]: 228.57949829101562
Valition (on train):
Valition (on test):
Accuracy (on test): 0.26
 49%|██████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 49/100 [00:01<00:01, 29.51it/s]
loss: [400]: 223.6313934326172
Valition (on train):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 27.98it/s]
  3%|█████▎                                                                                                                                                                           | 3/100 [00:00<00:03, 24.92it/s]

 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 79/100 [00:02<00:00, 36.33it/s]
loss: [500]: 220.70237731933594
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.74it/s]
 44%|█████████████████████████████████████████████████████████████████████████████▍                                                                                                  | 44/100 [00:01<00:01, 36.27it/s]
loss: [600]: 219.046875
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.38it/s]

 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 80/100 [00:02<00:00, 35.09it/s]
loss: [700]: 217.09686279296875
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.88it/s]
 44%|█████████████████████████████████████████████████████████████████████████████▍                                                                                                  | 44/100 [00:01<00:01, 36.10it/s]
loss: [800]: 213.51817321777344
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.65it/s]
  4%|███████                                                                                                                                                                          | 4/100 [00:00<00:03, 31.43it/s]
Valition (on test):

 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 76/100 [00:02<00:00, 35.88it/s]
loss: [900]: 211.4811553955078
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.13it/s]

 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋            | 93/100 [00:03<00:00, 26.21it/s]
loss: [1000]: 210.24876403808594
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 30.34it/s]
 47%|██████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 47/100 [00:01<00:01, 31.61it/s]
loss: [1100]: 208.3467254638672
Valition (on train):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.13it/s]
  8%|██████████████▏                                                                                                                                                                  | 8/100 [00:00<00:02, 36.15it/s]

 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 72/100 [00:02<00:00, 34.99it/s]
loss: [1200]: 206.54469299316406
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 30.51it/s]

 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 96/100 [00:02<00:00, 35.74it/s]
loss: [1300]: 203.9443817138672
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.02it/s]
 56%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                             | 56/100 [00:01<00:01, 35.70it/s]
loss: [1400]: 200.96022033691406
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.75it/s]

 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 83/100 [00:02<00:00, 31.02it/s]
loss: [1500]: 197.23745727539062
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 31.74it/s]
 48%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 48/100 [00:01<00:01, 36.69it/s]
loss: [1600]: 195.52743530273438
Valition (on train):

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.17it/s]
Accuracy (on test): 0.45
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 64/100 [00:01<00:00, 36.00it/s]
loss: [1700]: 195.38949584960938
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.13it/s]

 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 76/100 [00:02<00:00, 26.17it/s]
loss: [1800]: 193.21771240234375
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 28.34it/s]
 40%|██████████████████████████████████████████████████████████████████████▍                                                                                                         | 40/100 [00:01<00:01, 35.60it/s]
loss: [1900]: 190.24630737304688
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.18it/s]

 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 76/100 [00:02<00:00, 35.92it/s]
loss: [2000]: 190.54452514648438
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.88it/s]
 40%|██████████████████████████████████████████████████████████████████████▍                                                                                                         | 40/100 [00:01<00:01, 35.01it/s]
loss: [2100]: 188.9455108642578
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.56it/s]

 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 75/100 [00:02<00:00, 36.23it/s]
loss: [2200]: 190.2545928955078
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 34.87it/s]
 40%|██████████████████████████████████████████████████████████████████████▍                                                                                                         | 40/100 [00:01<00:01, 36.13it/s]
loss: [2300]: 192.60865783691406
Valition (on train):

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.96it/s]
Accuracy (on test): 0.51
 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 72/100 [00:01<00:00, 36.57it/s]
loss: [2400]: 186.7537384033203
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.78it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                       | 32/100 [00:00<00:01, 35.98it/s]
loss: [2500]: 188.0433349609375
Valition (on train):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.40it/s]
  0%|                                                                                                                                                                                         | 0/100 [00:00<?, ?it/s]

 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 72/100 [00:02<00:00, 35.02it/s]
loss: [2600]: 185.15553283691406
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.28it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 33.42it/s]
loss: [2700]: 186.36801147460938
Valition (on train):
Valition (on test):
Accuracy (on test): 0.63
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 64/100 [00:01<00:01, 35.35it/s]
loss: [2800]: 183.2572479248047
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.74it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.90it/s]
loss: [2900]: 182.25433349609375
Valition (on train):
Valition (on test):
Accuracy (on test): 0.58
 64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 64/100 [00:01<00:01, 35.74it/s]
loss: [3000]: 181.46408081054688
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 36.24it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.85it/s]
loss: [3100]: 181.00767517089844
Valition (on train):
Valition (on test):
Accuracy (on test): 0.61
 68%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 68/100 [00:01<00:00, 35.95it/s]
loss: [3200]: 181.98216247558594
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.76it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.17it/s]
loss: [3300]: 182.6059112548828
Valition (on train):
Valition (on test):
Accuracy (on test): 0.65
 47%|██████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 47/100 [00:01<00:01, 35.26it/s]
loss: [3400]: 179.37493896484375
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.31it/s]

 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 84/100 [00:02<00:00, 35.80it/s]
loss: [3500]: 180.50601196289062
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.43it/s]
 48%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 48/100 [00:01<00:01, 35.81it/s]
loss: [3600]: 178.4981689453125
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.23it/s]

 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 84/100 [00:02<00:00, 35.06it/s]
loss: [3700]: 176.2960968017578
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 35.32it/s]
 48%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 48/100 [00:01<00:01, 35.12it/s]
loss: [3800]: 173.6691131591797
Valition (on train):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 32.86it/s]
  0%|                                                                                                                                                                                         | 0/100 [00:00<?, ?it/s]

 59%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                        | 59/100 [00:02<00:02, 17.95it/s]
loss: [3900]: 172.7980499267578
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 27.63it/s]

 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 72/100 [00:02<00:00, 32.87it/s]
loss: [4000]: 176.52122497558594
Valition (on train):
Valition (on test):
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.25it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:03<00:00, 33.17it/s]
loss: [4100]: 173.32164001464844
Valition (on train):
Valition (on test):
Accuracy (on test): 0.71
 23%|████████████████████████████████████████▍                                                                                                                                       | 23/100 [00:00<00:02, 34.41it/s]
Traceback (most recent call last):
  File "/Users/tdeegan/dev/transformers/main.py", line 130, in <module>
    y_pred = model(x)
  File "/Users/tdeegan/dev/transformers/vit.py", line 119, in __call__
    x = self.encoder_blocks(x)
  File "/Users/tdeegan/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/tdeegan/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/Users/tdeegan/dev/transformers/vit.py", line 46, in __call__
    x = self.MLP(self.norm2(x)) + x
  File "/Users/tdeegan/dev/transformers/vit.py", line 30, in __call__
    x = self.activation_fn(l(x))
KeyboardInterrupt