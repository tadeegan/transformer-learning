ViT(
  (positional_embedding): PositionalEmbedding2d()
  (encoder_blocks): Sequential(
    (0): TransformerEncoderBlock(
      (norm1): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((28,), eps=1e-05, elementwise_affine=True)
      (msa): MultiHeadSelfAttention(
        (lin_k): Linear(in_features=28, out_features=28, bias=True)
        (lin_q): Linear(in_features=28, out_features=28, bias=True)
        (lin_v): Linear(in_features=28, out_features=28, bias=True)
      )
      (MLP): MLP(
        (layers): ModuleList(
          (0): Linear(in_features=28, out_features=28, bias=True)
          (1): Linear(in_features=28, out_features=28, bias=True)
        )
      )
    )
  )
  (final_mlp): MLP(
    (layers): ModuleList(
      (0): Linear(in_features=28, out_features=10, bias=True)
    )
  )
)
patches_train.shape: (60000, 49, 16)
learning rate: 0.018957345971563982
tensor([[-6.7414e-01, -2.0279e-01,  4.8217e-01,  2.3394e-02,  4.6399e-01,
          1.3978e-01, -4.3580e-01, -3.5338e-01,  5.9013e-01,  5.9876e-02],
        [-6.4481e-01, -2.1321e-01,  4.5816e-01,  5.9910e-03,  4.4436e-01,
          1.6982e-01, -4.0188e-01, -3.0849e-01,  5.8349e-01,  4.8326e-02],
        [-6.8388e-01, -2.0917e-01,  4.9667e-01,  4.9361e-02,  4.5544e-01,
          1.5381e-01, -4.2634e-01, -3.7075e-01,  5.7710e-01,  4.6352e-02],
        [-6.7891e-01, -2.1299e-01,  5.1243e-01,  2.4244e-02,  4.3435e-01,
          1.5377e-01, -4.2804e-01, -3.5805e-01,  5.9710e-01,  5.2887e-02],
        [-6.6083e-01, -2.2290e-01,  4.9623e-01,  3.3204e-02,  4.5305e-01,
          1.4571e-01, -4.4099e-01, -3.5472e-01,  5.7931e-01,  4.5374e-02],
        [-6.7164e-01, -2.3222e-01,  4.8170e-01,  1.2536e-02,  4.6636e-01,
          1.2943e-01, -4.6377e-01, -3.4487e-01,  5.9120e-01,  4.9527e-02],
        [-6.9823e-01, -2.0947e-01,  5.2350e-01,  2.7311e-02,  4.4256e-01,
          1.5723e-01, -4.3838e-01, -3.6828e-01,  6.0277e-01,  5.1256e-02],
        [-6.7733e-01, -2.2167e-01,  4.5119e-01,  1.7422e-02,  4.8426e-01,
          1.3395e-01, -4.3811e-01, -3.5571e-01,  5.9165e-01,  5.7739e-02],
        [-7.1413e-01, -2.2285e-01,  5.5040e-01,  3.5639e-02,  4.4497e-01,
          1.4100e-01, -4.5990e-01, -3.9658e-01,  6.1321e-01,  5.5252e-02],
        [-6.7194e-01, -2.1004e-01,  4.8608e-01,  7.1107e-03,  4.4001e-01,
          1.6685e-01, -4.0944e-01, -3.3743e-01,  6.0477e-01,  5.4979e-02],
        [-6.7665e-01, -2.2188e-01,  4.8634e-01,  7.8556e-03,  4.5688e-01,
          1.5858e-01, -4.3152e-01, -3.3377e-01,  6.0040e-01,  5.2808e-02],
        [-6.7243e-01, -1.9992e-01,  5.1351e-01,  3.0195e-02,  4.2704e-01,
          1.6293e-01, -4.2031e-01, -3.5053e-01,  5.9571e-01,  5.0794e-02],
        [-6.7237e-01, -2.3383e-01,  4.5311e-01,  3.2868e-02,  4.9197e-01,
          1.2472e-01, -4.4102e-01, -3.5323e-01,  5.6602e-01,  5.2803e-02],
        [-6.6582e-01, -2.0579e-01,  4.6080e-01,  1.3014e-02,  4.5505e-01,
          1.6183e-01, -4.1637e-01, -3.2864e-01,  5.9418e-01,  5.5011e-02],
        [-7.3516e-01, -1.9386e-01,  5.5298e-01,  2.3046e-02,  4.3996e-01,
          1.6112e-01, -4.5114e-01, -4.0076e-01,  6.3214e-01,  6.2319e-02],
        [-6.7226e-01, -2.0776e-01,  4.9196e-01,  1.0941e-02,  4.3717e-01,
          1.5321e-01, -4.4218e-01, -3.3473e-01,  5.9100e-01,  5.3296e-02],
        [-6.8796e-01, -2.0491e-01,  4.9601e-01,  1.1374e-02,  4.4738e-01,
          1.4759e-01, -4.5081e-01, -3.4933e-01,  6.0344e-01,  5.8616e-02],
        [-6.4515e-01, -2.2638e-01,  4.6755e-01,  2.5787e-02,  4.6172e-01,
          1.5127e-01, -4.2748e-01, -3.2706e-01,  5.9082e-01,  4.1448e-02],
        [-6.8664e-01, -2.2849e-01,  5.6274e-01,  2.5436e-02,  4.3175e-01,
          1.5493e-01, -4.6857e-01, -3.8071e-01,  6.0472e-01,  3.9078e-02],
        [-6.6737e-01, -2.1816e-01,  5.2048e-01,  3.3993e-02,  4.3239e-01,
          1.5261e-01, -4.4920e-01, -3.5010e-01,  5.8173e-01,  4.2998e-02],
        [-6.6334e-01, -2.3502e-01,  4.5989e-01,  1.2402e-02,  4.8440e-01,
          1.1514e-01, -4.6031e-01, -3.4240e-01,  5.8801e-01,  6.2321e-02],
        [-6.5871e-01, -2.0957e-01,  4.4066e-01,  1.9693e-03,  4.6138e-01,
          1.5156e-01, -4.2051e-01, -3.1954e-01,  5.8561e-01,  6.6840e-02],
        [-6.7453e-01, -2.2451e-01,  5.1544e-01,  2.7830e-02,  4.4153e-01,
          1.4178e-01, -4.4521e-01, -3.6376e-01,  5.9537e-01,  4.7021e-02],
        [-6.8058e-01, -2.1654e-01,  5.2179e-01,  2.8349e-02,  4.3758e-01,
          1.5422e-01, -4.3674e-01, -3.6279e-01,  5.9508e-01,  5.1277e-02],
        [-6.3542e-01, -2.0362e-01,  4.5888e-01,  4.3465e-02,  4.3894e-01,
          1.6308e-01, -3.9531e-01, -3.2484e-01,  5.5447e-01,  3.7917e-02],
        [-6.4906e-01, -2.2415e-01,  4.2321e-01,  1.4408e-02,  4.8048e-01,
          1.2881e-01, -4.4480e-01, -3.2194e-01,  5.7064e-01,  5.6048e-02],
        [-7.0273e-01, -2.0847e-01,  5.3294e-01,  3.2333e-02,  4.3819e-01,
          1.6039e-01, -4.3533e-01, -3.7433e-01,  6.0214e-01,  5.0903e-02],
        [-6.4899e-01, -2.2290e-01,  3.9533e-01, -1.9097e-03,  5.0063e-01,
          1.1567e-01, -4.4367e-01, -3.2164e-01,  5.8721e-01,  7.1864e-02],
        [-6.6451e-01, -2.2251e-01,  4.3727e-01, -1.2161e-02,  4.8438e-01,
          1.2132e-01, -4.5026e-01, -3.3575e-01,  5.9323e-01,  6.7430e-02],
        [-6.9501e-01, -2.0215e-01,  5.1305e-01,  2.9063e-02,  4.3102e-01,
          1.5577e-01, -4.3105e-01, -3.6240e-01,  5.9638e-01,  5.5558e-02],
        [-6.5203e-01, -2.1712e-01,  4.9298e-01, -6.3460e-03,  4.4209e-01,
          1.5734e-01, -4.4445e-01, -3.2338e-01,  6.1165e-01,  4.6697e-02],
        [-6.8782e-01, -2.1776e-01,  4.6092e-01,  1.3733e-02,  4.8174e-01,
          1.2943e-01, -4.4727e-01, -3.5800e-01,  5.9553e-01,  6.7084e-02],
        [-6.6752e-01, -2.2645e-01,  5.1416e-01,  2.8407e-02,  4.4645e-01,
          1.4452e-01, -4.4400e-01, -3.5481e-01,  5.9064e-01,  4.4638e-02],
        [-6.5740e-01, -2.0908e-01,  4.9946e-01,  7.0293e-03,  4.3351e-01,
          1.6375e-01, -4.3280e-01, -3.2793e-01,  6.0565e-01,  5.0010e-02],
        [-6.5421e-01, -2.2995e-01,  4.5423e-01,  1.7956e-02,  4.7434e-01,
          1.3341e-01, -4.5147e-01, -3.3408e-01,  5.7423e-01,  4.7173e-02],
        [-6.5707e-01, -2.1984e-01,  5.2754e-01,  2.8553e-02,  4.3717e-01,
          1.6069e-01, -4.4003e-01, -3.5197e-01,  5.9678e-01,  3.3574e-02],
        [-6.7729e-01, -2.2780e-01,  4.4699e-01,  8.5084e-03,  4.8366e-01,
          1.3213e-01, -4.3970e-01, -3.4190e-01,  5.9536e-01,  6.6271e-02],
        [-6.6295e-01, -2.2966e-01,  4.5817e-01, -4.2408e-04,  4.6231e-01,
          1.4841e-01, -4.4152e-01, -3.2324e-01,  5.9158e-01,  5.5165e-02],
        [-6.3316e-01, -2.0354e-01,  4.6877e-01,  1.1457e-02,  4.1903e-01,
          1.7666e-01, -4.0530e-01, -2.9934e-01,  5.8638e-01,  4.8289e-02],
        [-6.6100e-01, -2.3312e-01,  4.9531e-01,  1.2866e-02,  4.5945e-01,
          1.4692e-01, -4.4905e-01, -3.4467e-01,  5.9760e-01,  4.2088e-02],
        [-6.9637e-01, -2.2050e-01,  5.4206e-01,  2.8311e-02,  4.3986e-01,
          1.5186e-01, -4.4954e-01, -3.7752e-01,  6.1033e-01,  5.2004e-02],
        [-6.6182e-01, -2.3449e-01,  4.7113e-01,  2.5766e-02,  4.7265e-01,
          1.5101e-01, -4.1489e-01, -3.3769e-01,  5.8454e-01,  4.3027e-02],
        [-6.7746e-01, -2.1214e-01,  5.2335e-01,  3.0850e-02,  4.2459e-01,
          1.6467e-01, -4.2722e-01, -3.5452e-01,  5.9201e-01,  4.4372e-02],
        [-6.7263e-01, -2.1403e-01,  5.0661e-01,  3.0469e-02,  4.4054e-01,
          1.5493e-01, -4.3462e-01, -3.5281e-01,  5.8474e-01,  4.5700e-02],
        [-6.6631e-01, -1.9319e-01,  5.0315e-01,  3.8287e-02,  4.3162e-01,
          1.4620e-01, -4.3376e-01, -3.5709e-01,  5.8858e-01,  5.0857e-02],
        [-6.6326e-01, -2.1120e-01,  4.8122e-01,  1.8718e-02,  4.5911e-01,
          1.6832e-01, -4.2291e-01, -3.4352e-01,  5.9951e-01,  4.0208e-02],
        [-6.5720e-01, -2.2050e-01,  4.8614e-01,  4.3683e-03,  4.5151e-01,
          1.5531e-01, -4.2921e-01, -3.4787e-01,  6.0840e-01,  4.3247e-02],
        [-6.6446e-01, -2.2927e-01,  4.9374e-01,  3.1080e-02,  4.5728e-01,
          1.3888e-01, -4.4194e-01, -3.5690e-01,  5.8078e-01,  4.4312e-02],
        [-6.9507e-01, -2.1247e-01,  5.1973e-01,  3.1484e-02,  4.5167e-01,
          1.5821e-01, -4.4055e-01, -3.7830e-01,  5.9788e-01,  4.6080e-02],
        [-6.6994e-01, -2.3218e-01,  4.6688e-01,  1.5694e-02,  4.8535e-01,
          1.2340e-01, -4.5776e-01, -3.5034e-01,  5.9319e-01,  5.7729e-02],
        [-6.6304e-01, -2.1053e-01,  5.3368e-01,  7.7316e-03,  4.2943e-01,
          1.5515e-01, -4.4908e-01, -3.4264e-01,  6.0624e-01,  4.4606e-02],
        [-6.4125e-01, -2.1541e-01,  3.9487e-01, -1.3481e-04,  4.8813e-01,
          1.2571e-01, -4.2511e-01, -3.1250e-01,  5.6559e-01,  6.4486e-02],
        [-6.6048e-01, -2.0879e-01,  4.7971e-01, -8.4058e-03,  4.4539e-01,
          1.5302e-01, -4.3347e-01, -3.1902e-01,  6.0888e-01,  5.4921e-02],
        [-6.8878e-01, -2.1527e-01,  5.0693e-01,  4.5979e-02,  4.4624e-01,
          1.6297e-01, -4.2414e-01, -3.6276e-01,  5.7379e-01,  4.2210e-02],
        [-6.6895e-01, -2.0735e-01,  4.9143e-01,  8.5543e-04,  4.3774e-01,
          1.6649e-01, -4.3457e-01, -3.2998e-01,  6.0896e-01,  4.9947e-02],
        [-6.5305e-01, -2.1955e-01,  4.5145e-01,  1.4349e-02,  4.6464e-01,
          1.3393e-01, -4.3387e-01, -3.3326e-01,  5.8562e-01,  5.3488e-02],
        [-6.7915e-01, -2.1902e-01,  4.2510e-01, -4.2043e-03,  4.9746e-01,
          1.1238e-01, -4.5384e-01, -3.4346e-01,  5.9538e-01,  7.7789e-02],
        [-6.8677e-01, -2.2692e-01,  5.1710e-01,  2.9564e-02,  4.5743e-01,
          1.4313e-01, -4.5241e-01, -3.7095e-01,  6.0515e-01,  4.7933e-02],
        [-6.5907e-01, -2.2184e-01,  4.4086e-01,  1.0320e-02,  4.7890e-01,
          1.4642e-01, -4.2819e-01, -3.2943e-01,  5.9143e-01,  5.6452e-02],
        [-6.7696e-01, -2.1234e-01,  5.1959e-01,  3.4844e-02,  4.3317e-01,
          1.6457e-01, -4.3097e-01, -3.5349e-01,  5.8195e-01,  3.8273e-02],
        [-6.6849e-01, -1.8886e-01,  4.5675e-01, -4.2919e-03,  4.4204e-01,
          1.7367e-01, -4.1567e-01, -3.1817e-01,  6.0791e-01,  5.8926e-02],
        [-6.8457e-01, -2.1643e-01,  4.9140e-01,  4.3359e-02,  4.5384e-01,
          1.5360e-01, -4.2029e-01, -3.6305e-01,  5.8404e-01,  5.2475e-02],
        [-6.8235e-01, -2.3142e-01,  4.9211e-01,  1.2912e-02,  4.7165e-01,
          1.2809e-01, -4.6161e-01, -3.5722e-01,  5.9301e-01,  5.7783e-02],
        [-6.5011e-01, -2.2726e-01,  4.1982e-01, -5.1630e-03,  4.9724e-01,
          1.2787e-01, -4.5085e-01, -3.2574e-01,  5.8894e-01,  5.4627e-02],
        [-6.7679e-01, -2.1862e-01,  4.7406e-01,  2.5581e-02,  4.6036e-01,
          1.4736e-01, -4.1801e-01, -3.4589e-01,  5.7670e-01,  4.9455e-02],
        [-6.7376e-01, -1.9779e-01,  5.1448e-01,  1.6287e-02,  4.2735e-01,
          1.7153e-01, -4.2293e-01, -3.4819e-01,  6.0329e-01,  4.7340e-02],
        [-6.7284e-01, -2.1074e-01,  4.8124e-01,  4.1671e-03,  4.4528e-01,
          1.5193e-01, -4.3088e-01, -3.3226e-01,  5.9857e-01,  5.5231e-02],
        [-6.7152e-01, -2.2332e-01,  5.2157e-01,  3.3984e-02,  4.3271e-01,
          1.5126e-01, -4.4197e-01, -3.5328e-01,  5.8547e-01,  4.4692e-02],
        [-6.7095e-01, -2.3078e-01,  4.9899e-01,  2.4832e-02,  4.6121e-01,
          1.3974e-01, -4.4605e-01, -3.4966e-01,  5.8154e-01,  3.8484e-02],
        [-6.6733e-01, -2.2434e-01,  4.3245e-01, -6.5437e-03,  4.8549e-01,
          1.3028e-01, -4.5055e-01, -3.2866e-01,  5.9811e-01,  6.4688e-02],
        [-6.9659e-01, -2.1385e-01,  5.2003e-01,  1.0041e-02,  4.5170e-01,
          1.4502e-01, -4.6276e-01, -3.6727e-01,  6.2292e-01,  5.8279e-02],
        [-6.6235e-01, -2.0893e-01,  5.1541e-01,  2.0017e-02,  4.3376e-01,
          1.6491e-01, -4.2874e-01, -3.4510e-01,  5.9097e-01,  3.5257e-02],
        [-7.1873e-01, -2.0454e-01,  5.5360e-01,  2.0690e-02,  4.3489e-01,
          1.6417e-01, -4.4664e-01, -3.8888e-01,  6.2940e-01,  5.6047e-02],
        [-6.5784e-01, -2.1362e-01,  4.7712e-01,  2.1591e-02,  4.4681e-01,
          1.5953e-01, -4.2748e-01, -3.2830e-01,  5.8303e-01,  3.8310e-02],
        [-6.7474e-01, -2.1883e-01,  4.9999e-01,  1.2093e-02,  4.6609e-01,
          1.3232e-01, -4.5356e-01, -3.6104e-01,  6.0212e-01,  5.6321e-02],
        [-6.4015e-01, -2.3299e-01,  4.5666e-01,  3.7570e-02,  4.7291e-01,
          1.3451e-01, -4.4464e-01, -3.3262e-01,  5.4934e-01,  3.3373e-02],
        [-6.8394e-01, -2.2409e-01,  5.0777e-01,  1.0052e-02,  4.4655e-01,
          1.5488e-01, -4.3818e-01, -3.4560e-01,  5.9699e-01,  5.2683e-02],
        [-6.8616e-01, -2.1496e-01,  5.1825e-01,  3.1661e-02,  4.4173e-01,
          1.5562e-01, -4.3830e-01, -3.6349e-01,  5.9317e-01,  5.0787e-02],
        [-6.8903e-01, -2.0772e-01,  5.1430e-01,  2.4741e-02,  4.4240e-01,
          1.6905e-01, -4.2993e-01, -3.5726e-01,  5.9195e-01,  4.4005e-02],
        [-6.4981e-01, -2.1531e-01,  4.9449e-01,  1.8122e-02,  4.3674e-01,
          1.5600e-01, -4.2824e-01, -3.3016e-01,  5.8551e-01,  3.9779e-02],
        [-6.5554e-01, -2.2599e-01,  4.7528e-01,  2.3122e-02,  4.5320e-01,
          1.5510e-01, -4.2766e-01, -3.3082e-01,  5.8358e-01,  4.0182e-02],
        [-6.4318e-01, -2.4584e-01,  4.5269e-01,  1.0238e-02,  4.7753e-01,
          1.3355e-01, -4.4242e-01, -3.2159e-01,  5.8024e-01,  4.9933e-02],
        [-6.3367e-01, -2.3387e-01,  4.0758e-01, -3.4163e-03,  4.8730e-01,
          1.4093e-01, -4.3682e-01, -3.0327e-01,  5.8584e-01,  5.2316e-02],
        [-6.6690e-01, -1.9799e-01,  4.8488e-01,  1.4090e-02,  4.5615e-01,
          1.5858e-01, -4.4286e-01, -3.3823e-01,  5.9797e-01,  4.3998e-02],
        [-6.6519e-01, -2.1256e-01,  5.0236e-01,  2.8709e-02,  4.5082e-01,
          1.4857e-01, -4.3695e-01, -3.6222e-01,  6.0424e-01,  4.7277e-02],
        [-6.6633e-01, -2.2488e-01,  4.6381e-01,  3.1596e-02,  4.6238e-01,
          1.5494e-01, -4.0882e-01, -3.3905e-01,  5.7306e-01,  4.9465e-02],
        [-6.8150e-01, -1.9662e-01,  4.6473e-01,  3.8524e-02,  4.6266e-01,
          1.4940e-01, -4.1301e-01, -3.6608e-01,  5.8458e-01,  5.4579e-02],
        [-6.4994e-01, -2.0400e-01,  4.6208e-01,  1.9564e-02,  4.4268e-01,
          1.6639e-01, -4.2564e-01, -3.2076e-01,  5.8552e-01,  4.4008e-02],
        [-6.8322e-01, -2.1322e-01,  4.4952e-01,  1.7667e-02,  4.7607e-01,
          1.4827e-01, -4.2079e-01, -3.4467e-01,  5.8376e-01,  5.3895e-02],
        [-6.5049e-01, -2.0286e-01,  4.9560e-01,  2.9019e-02,  4.4950e-01,
          1.5240e-01, -4.5297e-01, -3.4925e-01,  5.8652e-01,  3.4023e-02],
        [-6.6176e-01, -2.1008e-01,  4.7207e-01,  1.5602e-02,  4.5529e-01,
          1.5577e-01, -4.3375e-01, -3.3736e-01,  5.8898e-01,  4.3470e-02],
        [-6.6735e-01, -2.0840e-01,  5.1028e-01,  1.4686e-02,  4.4979e-01,
          1.5500e-01, -4.5755e-01, -3.5166e-01,  5.9963e-01,  4.4683e-02],
        [-7.4141e-01, -1.9529e-01,  5.3171e-01,  2.0301e-02,  4.5293e-01,
          1.6279e-01, -4.3977e-01, -4.0056e-01,  6.4669e-01,  7.0015e-02],
        [-6.7237e-01, -2.2324e-01,  4.8990e-01,  8.3028e-03,  4.6749e-01,
          1.5023e-01, -4.4981e-01, -3.4245e-01,  6.0920e-01,  4.5675e-02],
        [-6.7757e-01, -2.2320e-01,  4.7618e-01,  2.9876e-02,  4.6017e-01,
          1.3786e-01, -4.3695e-01, -3.5907e-01,  5.8088e-01,  5.9659e-02],
        [-6.6148e-01, -2.2875e-01,  4.3926e-01,  5.8791e-03,  4.8125e-01,
          1.3725e-01, -4.3895e-01, -3.2422e-01,  5.8296e-01,  5.4200e-02],
        [-6.8737e-01, -1.9967e-01,  5.0796e-01,  8.9805e-03,  4.2932e-01,
          1.7776e-01, -4.2165e-01, -3.4418e-01,  6.0907e-01,  4.7856e-02],
        [-6.5630e-01, -2.2174e-01,  4.6936e-01,  3.0543e-02,  4.6256e-01,
          1.4763e-01, -4.3145e-01, -3.4403e-01,  5.7019e-01,  4.5774e-02],
        [-6.7898e-01, -2.0960e-01,  5.1113e-01,  2.7184e-02,  4.4912e-01,
          1.4835e-01, -4.5150e-01, -3.6431e-01,  5.8951e-01,  4.8012e-02],
        [-6.8283e-01, -2.0593e-01,  5.3203e-01,  3.0341e-02,  4.2655e-01,
          1.7186e-01, -4.2461e-01, -3.6256e-01,  5.9559e-01,  4.1184e-02]],
       grad_fn=<AddmmBackward0>)
  0%|                                                                                                                                                                                         | 0/600 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/Users/tdeegan/dev/transformers/main.py", line 124, in <module>
    y_pred = model(x)
  File "/Users/tdeegan/dev/transformers/vit.py", line 123, in __call__
    return F.softmax(self.final_mlp(x[..., 0, :]), dim=-2)
  File "/Users/tdeegan/dev/transformers/vit.py", line 30, in __call__
    x = self.activation_fn(l(x))
  File "/Users/tdeegan/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/tdeegan/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x10 and 28x10)