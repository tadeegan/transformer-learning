{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1zotEl0DU9va-Y1Zc1jlLpSwJqtfGvBkc","timestamp":1673864286787}],"authorship_tag":"ABX9TyPhLbhdLP6UmhMfWJyCeS4B"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"8af89dfbc5f747d196e0e3acb47e898f":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_5bd7231da8fb4a099447a1b6fcad6092","IPY_MODEL_66c50f9f5f9f4fac88de3be4af98bde5"],"layout":"IPY_MODEL_a209551357a3438091ecef2619bce7d1"}},"5bd7231da8fb4a099447a1b6fcad6092":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_99b08eb805bf4a86adc013e0026d4bd8","placeholder":"​","style":"IPY_MODEL_2ce1e117e1824b38ace68c534e681b1d","value":"0.001 MB of 0.001 MB uploaded (0.000 MB deduped)\r"}},"66c50f9f5f9f4fac88de3be4af98bde5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_545ff382b93a4daca4a3f4148f08cf57","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_725ebebe46d845018a7d305635dcd5de","value":1}},"a209551357a3438091ecef2619bce7d1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"99b08eb805bf4a86adc013e0026d4bd8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ce1e117e1824b38ace68c534e681b1d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"545ff382b93a4daca4a3f4148f08cf57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"725ebebe46d845018a7d305635dcd5de":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6qJHQ9Z23CeA","executionInfo":{"status":"ok","timestamp":1673899180601,"user_tz":480,"elapsed":1197,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"6eafee9b-d15a-455c-bdba-6b0c7a71fd10"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["#@title Your Title Here\n","!pip install wandb --upgrade > /dev/null"],"metadata":{"id":"BRyG13m86LsL","executionInfo":{"status":"ok","timestamp":1673899186483,"user_tz":480,"elapsed":5885,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["!nvidia-smi"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"URJt2Ec354TD","executionInfo":{"status":"ok","timestamp":1673899186483,"user_tz":480,"elapsed":9,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"a578e2e7-0a60-4130-f102-d1e9b96ae284"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mon Jan 16 19:59:46 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   68C    P8    11W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["cd \"drive/Othercomputers/My MacBook Pro (corp)/transformers\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E1baG1O_3ki1","executionInfo":{"status":"ok","timestamp":1673899186483,"user_tz":480,"elapsed":5,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"0f3c31f2-a924-4a23-e0aa-9d1c4500756a"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/Othercomputers/My MacBook Pro (corp)/transformers\n"]}]},{"cell_type":"code","source":["%load_ext autoreload\n","%autoreload 2\n","from importlib import reload"],"metadata":{"id":"SSAE-J7S5k5q","executionInfo":{"status":"ok","timestamp":1673899186720,"user_tz":480,"elapsed":240,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["import main\n","main.train(type='CONV')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":767,"referenced_widgets":["8af89dfbc5f747d196e0e3acb47e898f","5bd7231da8fb4a099447a1b6fcad6092","66c50f9f5f9f4fac88de3be4af98bde5","a209551357a3438091ecef2619bce7d1","99b08eb805bf4a86adc013e0026d4bd8","2ce1e117e1824b38ace68c534e681b1d","545ff382b93a4daca4a3f4148f08cf57","725ebebe46d845018a7d305635dcd5de"]},"id":"Jjhd_fVP4DNU","outputId":"12763280-96d4-4ac1-a4a9-cb06de547bba"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Finishing last run (ID:viufmnvg) before initializing another..."]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='0.001 MB of 0.001 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, max…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8af89dfbc5f747d196e0e3acb47e898f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>███▂▂▂▁</td></tr><tr><td>loss</td><td>██▇▃▁▆▆</td></tr><tr><td>train/accuracy</td><td>▁▁▁▁▁▁▁</td></tr><tr><td>validation/accuracy</td><td>▁▁▁▁▁▁▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>1e-05</td></tr><tr><td>loss</td><td>22.78802</td></tr><tr><td>train/accuracy</td><td>1.0</td></tr><tr><td>validation/accuracy</td><td>1.0</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run <strong style=\"color:#cdcd00\">efficient-cherry-138</strong> at: <a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/viufmnvg\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/viufmnvg</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20230116_202323-viufmnvg/logs</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Successfully finished last run (ID:viufmnvg). Initializing new run:<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.13.9"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/drive/Othercomputers/My MacBook Pro (corp)/transformers/wandb/run-20230116_202413-gv1trvbi</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/gv1trvbi\" target=\"_blank\">fresh-plant-139</a></strong> to <a href=\"https://wandb.ai/tadeegan/vit-transformer\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View project at <a href=\"https://wandb.ai/tadeegan/vit-transformer\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run at <a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/gv1trvbi\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/gv1trvbi</a>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["#params: 1199882\n","train_set.shape: (60000, 1, 28, 28)\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 600/600 [00:03<00:00, 175.59it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [600]: 27.18825340270996\n","Accuracy (on test): 0.964\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 600/600 [00:03<00:00, 176.35it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [1200]: 24.623075485229492\n","Accuracy (on test): 0.984\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 600/600 [00:03<00:00, 175.25it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [1800]: 26.178730010986328\n","Accuracy (on test): 0.984\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 600/600 [00:03<00:00, 174.03it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [2400]: 27.238590240478516\n","Accuracy (on test): 0.986\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 600/600 [00:03<00:00, 174.98it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [3000]: 20.835693359375\n","Accuracy (on test): 0.987\n"]},{"output_type":"stream","name":"stderr","text":[" 20%|██        | 123/600 [00:00<00:02, 162.63it/s]\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"hgVVGZlkOdvU"},"execution_count":null,"outputs":[]}]}