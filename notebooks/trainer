{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":34890,"status":"ok","timestamp":1679175960940,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"},"user_tz":360},"id":"6qJHQ9Z23CeA","outputId":"024d1998-76da-4cab-8891-89abb51df542"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":12023,"status":"ok","timestamp":1679175972959,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"},"user_tz":360},"id":"BRyG13m86LsL","cellView":"form"},"outputs":[],"source":["#@title Your Title Here\n","!pip install wandb --upgrade > /dev/null"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":668,"status":"ok","timestamp":1679175973624,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"},"user_tz":360},"id":"URJt2Ec354TD","outputId":"8c6c7ffc-152a-47f0-e4a7-f45deceafd9b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Sat Mar 18 21:46:13 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   54C    P0    26W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["!nvidia-smi"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1679175988992,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"},"user_tz":360},"id":"E1baG1O_3ki1","outputId":"cbca75dc-1de4-4dbf-e5e2-b6de5f9647f4"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/Othercomputers/My MacBook Pro (corp)/transformers\n"]}],"source":["cd \"drive/Othercomputers/My MacBook Pro (corp)/transformers\""]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":312,"status":"ok","timestamp":1679175991892,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"},"user_tz":360},"id":"SSAE-J7S5k5q"},"outputs":[],"source":["%load_ext autoreload\n","%autoreload 2\n","from importlib import reload"]},{"cell_type":"code","source":["import torch\n","torch.__version__"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"0qyRpG7uslO0","executionInfo":{"status":"ok","timestamp":1679176782174,"user_tz":360,"elapsed":2014,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"fed4184f-86cc-46a4-e495-0f366e104269"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'1.13.1+cu116'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":11}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"Jjhd_fVP4DNU","outputId":"478e5c27-5cd8-484b-c13f-9a259c579e71"},"outputs":[{"output_type":"stream","name":"stdout","text":["env: WANDB_MODE=disabled\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Changes to your `wandb` environment variables will be ignored because your `wandb` session has already started. For more information on how to modify your settings with `wandb.init()` arguments, please refer to <a href='https://wandb.me/wandb-init' target=\"_blank\">the W&B docs</a>."]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Finishing last run (ID:ofhl20e2) before initializing another..."]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>██████▂▂▂▁▁▁▁▁▁▁</td></tr><tr><td>loss</td><td>█▃▆▅▃▄▅▃▄▂▁▄▄▂▄▂</td></tr><tr><td>model/parameters</td><td>▁</td></tr><tr><td>train/accuracy</td><td>▁▅▆▇▇▇▇█████████</td></tr><tr><td>validation/accuracy</td><td>▁▅▇█▇▇▇▇▇▇▇▇▇▇▇▇</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>0.0</td></tr><tr><td>loss</td><td>15.35656</td></tr><tr><td>model/parameters</td><td>1199882</td></tr><tr><td>train/accuracy</td><td>0.99</td></tr><tr><td>validation/accuracy</td><td>0.987</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run <strong style=\"color:#cdcd00\">worthy-snow-198</strong> at: <a href='https://wandb.ai/tadeegan/vit-transformer/runs/ofhl20e2' target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/ofhl20e2</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20230318_232241-ofhl20e2/logs</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Successfully finished last run (ID:ofhl20e2). Initializing new run:<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.14.0"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/drive/Othercomputers/My MacBook Pro (corp)/transformers/wandb/run-20230318_232843-tfkxezwb</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href='https://wandb.ai/tadeegan/vit-transformer/runs/tfkxezwb' target=\"_blank\">dandy-meadow-199</a></strong> to <a href='https://wandb.ai/tadeegan/vit-transformer' target=\"_blank\">Weights & Biases</a> (<a href='https://wandb.me/run' target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View project at <a href='https://wandb.ai/tadeegan/vit-transformer' target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run at <a href='https://wandb.ai/tadeegan/vit-transformer/runs/tfkxezwb' target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/tfkxezwb</a>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["#params: 403098\n","train_set.shape: (60000, 49, 16)\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.49it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [937]: 123.99034118652344\n","Accuracy (on train): 0.559\n","Accuracy (on test): 0.531\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.09it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [1874]: 113.67083740234375\n","Accuracy (on train): 0.756\n","Accuracy (on test): 0.728\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.40it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [2811]: 109.25151062011719\n","Accuracy (on train): 0.797\n","Accuracy (on test): 0.782\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 53.53it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [3748]: 109.93953704833984\n","Accuracy (on train): 0.823\n","Accuracy (on test): 0.807\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 54.41it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [4685]: 106.5931396484375\n","Accuracy (on train): 0.844\n","Accuracy (on test): 0.828\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.63it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [5622]: 104.95685577392578\n","Accuracy (on train): 0.842\n","Accuracy (on test): 0.827\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 54.61it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [6559]: 103.61390686035156\n","Accuracy (on train): 0.855\n","Accuracy (on test): 0.831\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 54.66it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [7496]: 103.24893188476562\n","Accuracy (on train): 0.862\n","Accuracy (on test): 0.837\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.74it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [8433]: 103.02450561523438\n","Accuracy (on train): 0.865\n","Accuracy (on test): 0.847\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.85it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [9370]: 104.8048095703125\n","Accuracy (on train): 0.868\n","Accuracy (on test): 0.856\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.33it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [10307]: 103.48008728027344\n","Accuracy (on train): 0.868\n","Accuracy (on test): 0.863\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 55.08it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [11244]: 103.75132751464844\n","Accuracy (on train): 0.87\n","Accuracy (on test): 0.869\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.05it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [12181]: 103.48684692382812\n","Accuracy (on train): 0.875\n","Accuracy (on test): 0.865\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.34it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [13118]: 103.40277099609375\n","Accuracy (on train): 0.87\n","Accuracy (on test): 0.866\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:15<00:00, 58.80it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [14055]: 102.84291076660156\n","Accuracy (on train): 0.876\n","Accuracy (on test): 0.867\n","Epoch 00015: reducing learning rate of group 0 to 1.0000e-04.\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.16it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [14992]: 101.88934326171875\n","Accuracy (on train): 0.878\n","Accuracy (on test): 0.877\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.14it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [15929]: 101.80799865722656\n","Accuracy (on train): 0.881\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 56.24it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [16866]: 101.76981353759766\n","Accuracy (on train): 0.883\n","Accuracy (on test): 0.879\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 55.48it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [17803]: 101.70878601074219\n","Accuracy (on train): 0.882\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.49it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [18740]: 101.66740417480469\n","Accuracy (on train): 0.883\n","Accuracy (on test): 0.882\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 58.45it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [19677]: 101.63410186767578\n","Accuracy (on train): 0.883\n","Accuracy (on test): 0.882\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:15<00:00, 58.67it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [20614]: 101.61183166503906\n","Accuracy (on train): 0.884\n","Accuracy (on test): 0.882\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 56.88it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [21551]: 101.59980010986328\n","Accuracy (on train): 0.885\n","Accuracy (on test): 0.881\n","Epoch 00023: reducing learning rate of group 0 to 1.0000e-05.\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 55.53it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [22488]: 101.46356201171875\n","Accuracy (on train): 0.885\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:17<00:00, 53.43it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [23425]: 101.46321105957031\n","Accuracy (on train): 0.886\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 55.21it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [24362]: 101.45967102050781\n","Accuracy (on train): 0.886\n","Accuracy (on test): 0.88\n","Epoch 00026: reducing learning rate of group 0 to 1.0000e-06.\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.82it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [25299]: 101.45529174804688\n","Accuracy (on train): 0.885\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [26236]: 101.45848083496094\n","Accuracy (on train): 0.885\n","Accuracy (on test): 0.88\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 937/937 [00:16<00:00, 57.27it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [27173]: 101.46005249023438\n","Accuracy (on train): 0.885\n","Accuracy (on test): 0.88\n","Epoch 00029: reducing learning rate of group 0 to 1.0000e-07.\n"]},{"output_type":"stream","name":"stderr","text":[" 93%|█████████▎| 868/937 [00:16<00:01, 65.67it/s]"]}],"source":["%env WANDB_MODE=disabled\n","import main\n","main.train(type='VIT')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hgVVGZlkOdvU"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1zotEl0DU9va-Y1Zc1jlLpSwJqtfGvBkc","timestamp":1673864286787}],"authorship_tag":"ABX9TyMHnt7vN3/LGFwQZCLndpN5"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}