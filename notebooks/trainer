{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1zotEl0DU9va-Y1Zc1jlLpSwJqtfGvBkc","timestamp":1673864286787}],"authorship_tag":"ABX9TyPhLbhdLP6UmhMfWJyCeS4B"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"1c39511dccf842569b9bd254c36ca21d":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_2364988d98ed41278dfb7c7765bf2e0c","IPY_MODEL_190d5d1d96164b0a93d4806496566819"],"layout":"IPY_MODEL_c4fdb7ddd2474c91b9f2aa98e7f2404f"}},"2364988d98ed41278dfb7c7765bf2e0c":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2397425505574371b6f15f48a763329c","placeholder":"​","style":"IPY_MODEL_5f4a440993db4d169ba6e49eea24ed03","value":"0.011 MB of 0.011 MB uploaded (0.000 MB deduped)\r"}},"190d5d1d96164b0a93d4806496566819":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_dbd838e17849465e9152ff91b94e2955","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_eacaef9364ec4d9a8b554bb2c7a9d645","value":0.9812442434899105}},"c4fdb7ddd2474c91b9f2aa98e7f2404f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2397425505574371b6f15f48a763329c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f4a440993db4d169ba6e49eea24ed03":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dbd838e17849465e9152ff91b94e2955":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eacaef9364ec4d9a8b554bb2c7a9d645":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6qJHQ9Z23CeA","executionInfo":{"status":"ok","timestamp":1673862495535,"user_tz":480,"elapsed":808,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"f9908f83-ffd9-486c-d573-3a2d448f8e46"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["#@title Your Title Here\n","!pip install wandb --upgrade > /dev/null"],"metadata":{"id":"BRyG13m86LsL","executionInfo":{"status":"ok","timestamp":1673862500968,"user_tz":480,"elapsed":5436,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["!nvidia-smi"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"URJt2Ec354TD","executionInfo":{"status":"ok","timestamp":1673862500969,"user_tz":480,"elapsed":22,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"d501f7b7-089a-44b6-e937-f594134f3c3d"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mon Jan 16 09:48:20 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   66C    P8    11W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["cd \"drive/Othercomputers/My MacBook Pro (corp)/transformers\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E1baG1O_3ki1","executionInfo":{"status":"ok","timestamp":1673862500969,"user_tz":480,"elapsed":18,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}},"outputId":"ec231904-d4a6-4920-b2af-13858b49ed40"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/Othercomputers/My MacBook Pro (corp)/transformers\n"]}]},{"cell_type":"code","source":["%load_ext autoreload\n","%autoreload 2\n","from importlib import reload"],"metadata":{"id":"SSAE-J7S5k5q","executionInfo":{"status":"ok","timestamp":1673862501134,"user_tz":480,"elapsed":181,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["import main\n","main.train(type='CONV')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":594,"referenced_widgets":["1c39511dccf842569b9bd254c36ca21d","2364988d98ed41278dfb7c7765bf2e0c","190d5d1d96164b0a93d4806496566819","c4fdb7ddd2474c91b9f2aa98e7f2404f","2397425505574371b6f15f48a763329c","5f4a440993db4d169ba6e49eea24ed03","dbd838e17849465e9152ff91b94e2955","eacaef9364ec4d9a8b554bb2c7a9d645"]},"id":"Jjhd_fVP4DNU","outputId":"01789bbf-716e-4a4a-9d0f-b64be1d4e3a5"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Finishing last run (ID:yt2pzkdv) before initializing another..."]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='0.001 MB of 0.011 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=0.083647…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1c39511dccf842569b9bd254c36ca21d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>████▂▂▂▁▁▁▁▁▁▁▁▁</td></tr><tr><td>loss</td><td>██▆▂▂▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/accuracy</td><td>▁▂▂▅▆▆▆▆▆▆▆▇████</td></tr><tr><td>validation/accuracy</td><td>▁██▆▃▃▁▁▁▁▁▃▃▃▃▃</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>learning_rate</td><td>0.0</td></tr><tr><td>loss</td><td>439.23257</td></tr><tr><td>train/accuracy</td><td>0.29</td></tr><tr><td>validation/accuracy</td><td>0.12</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run <strong style=\"color:#cdcd00\">drawn-snow-106</strong> at: <a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/yt2pzkdv\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/yt2pzkdv</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20230116_101706-yt2pzkdv/logs</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Successfully finished last run (ID:yt2pzkdv). Initializing new run:<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.13.9"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/drive/Othercomputers/My MacBook Pro (corp)/transformers/wandb/run-20230116_101755-nqvqr0ka</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/nqvqr0ka\" target=\"_blank\">faithful-yogurt-107</a></strong> to <a href=\"https://wandb.ai/tadeegan/vit-transformer\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View project at <a href=\"https://wandb.ai/tadeegan/vit-transformer\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run at <a href=\"https://wandb.ai/tadeegan/vit-transformer/runs/nqvqr0ka\" target=\"_blank\">https://wandb.ai/tadeegan/vit-transformer/runs/nqvqr0ka</a>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["train_set.shape: (60000, 784)\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 300/300 [00:02<00:00, 148.58it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [300]: 460.4067687988281\n","Accuracy (on test): 0.14\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 300/300 [00:01<00:00, 158.06it/s]\n"]},{"output_type":"stream","name":"stdout","text":["loss: [600]: 460.29931640625\n","Accuracy (on test): 0.14\n"]},{"output_type":"stream","name":"stderr","text":[" 34%|███▍      | 103/300 [00:00<00:01, 158.44it/s]"]}]},{"cell_type":"code","source":[],"metadata":{"id":"OVjtHuU14Xvn","executionInfo":{"status":"aborted","timestamp":1673862508607,"user_tz":480,"elapsed":19,"user":{"displayName":"Thomas Deegan","userId":"17274830908823002809"}}},"execution_count":null,"outputs":[]}]}